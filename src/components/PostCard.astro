---
import type { GhostPost } from '../lib/ghost';
import { formatDate } from '../lib/ghost';

interface Props {
  post: GhostPost;
  variant?: 'grid' | 'list';
}

const { post, variant = 'list' } = Astro.props;

const isGrid = variant === 'grid';
---

{isGrid ? (
  <!-- Grid variant: vertical card -->
  <article class="group">
    <a href={`/posts/${post.slug}`} class="block">
      {post.feature_image && (
        <div class="aspect-video overflow-hidden rounded-lg bg-[var(--color-bg-tertiary)] mb-4">
          <img
            src={post.feature_image}
            alt={post.title}
            class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
            loading="lazy"
          />
        </div>
      )}
      <h3 class="text-lg font-semibold text-[var(--color-text-primary)] group-hover:text-[var(--color-accent)] transition-colors mb-2 line-clamp-2">
        {post.title}
      </h3>
      <p class="text-sm text-[var(--color-text-muted)]">
        {post.primary_author?.name} &middot; {formatDate(post.published_at)}
      </p>
    </a>
  </article>
) : (
  <!-- List variant: horizontal with thumbnail -->
  <article class="group py-4 border-b border-[var(--color-border)] last:border-b-0">
    <a href={`/posts/${post.slug}`} class="flex gap-4">
      {post.feature_image && (
        <div class="flex-shrink-0 w-24 h-16 sm:w-32 sm:h-20 overflow-hidden rounded bg-[var(--color-bg-tertiary)]">
          <img
            src={post.feature_image}
            alt={post.title}
            class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
            loading="lazy"
          />
        </div>
      )}
      <div class="flex-1 min-w-0">
        <h3 class="text-base font-semibold text-[var(--color-text-primary)] group-hover:text-[var(--color-accent)] transition-colors line-clamp-2 mb-1">
          {post.title}
        </h3>
        <p class="text-xs text-[var(--color-text-muted)]">
          {post.primary_author?.name} &middot; {formatDate(post.published_at)} &middot; {post.reading_time} min read
        </p>
      </div>
    </a>
  </article>
)}
